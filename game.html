<!doctype html>
<html lang="en">
<head>
    <title>This is my final project Game</title>
    <script src="//cdn.jsdelivr.net/npm/phaser@3.11.0/dist/phaser.js"></script>
</head>
<body>
    <script type="text/javascript" id = 'TheGame'>
        
        var config = {
            type: Phaser.AUTO,
            width: 400,
            height: 300,
            physics:{
                default: 'arcade',
                arcade:{
                    gravity: {y: 400},
                    debug: false
                }
            },
            scene: {
                preload: preload,
                create: create,
                update: update
            }
        };

        var player;
        var ground;
        var score = 0;
        var scoreText = 0;
        var cursors;

        function preload()
        {
            this.load.image('ground', 'assets/ground.png');
            this.load.image('guy', 'assets/theGameBoy.png');
        }

        var game = new Phaser.Game(config);

        function create()
        {
            //Ground
            ground = this.physics.add.staticGroup();
            ground.create(200, 295, 'ground').setScale(4).refreshBody(); 

            //Player
            player = this.physics.add.sprite(100, 265, 'guy');
            player.setCollideWorldBounds(true);

            //Score
            scoreText = this.add.text(10,10, 'Score: 0', {fontSize: '16px', fill: '#000' } );
            
            cursors = this.input.keyboard.createCursorKeys();
            
            this.physics.add.collider(player, ground);
        }

        function update()
        {
            if(cursors.left.isDown)
            {
                player.setVelocityX(-85);
            }
            else if(cursors.right.isDown)
            {
                player.setVelocityX(85);
            }
            else
            {
                player.setVelocityX(0);
            }

            if (cursors.up.isDown && player.body.touching.down)
            {
                player.setVelocityY(-100);
            }

        }

    
    
    </script>
    <button id = 'pipToggle'>TogglePIP</button>
    
    <script>
        const game = document.getElementById("TheGame");
        const pipButton = document.getElementById("pipToggle");

        pipButton.addEventListener("click", async () => 
        {
                try
                {
                    if(document.pictureInPictureElement)
                    {
                        await game.requestPictureInPicture();
                    } else {
                        await document.exitPictureInPicture();
                    }
                } catch (err) {
                    //Picture in Picture mode failed to enter/leave
                }
        });


    </script>


</body>
</html>